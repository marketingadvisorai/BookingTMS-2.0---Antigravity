# BookingTMS System Architecture

> **Version**: 0.1.65  
> **Last Updated**: November 30, 2025

---

## Table of Contents
1. [System Overview](#system-overview)
2. [Entity Hierarchy](#entity-hierarchy)
3. [Database Schema](#database-schema)
4. [Widget System](#widget-system)
5. [Booking Flow](#booking-flow)
6. [Embed System](#embed-system)
7. [Time Slot Generation](#time-slot-generation)
8. [User Roles & Permissions](#user-roles--permissions)
9. [Key Services](#key-services)
10. [File Structure](#file-structure)

---

## System Overview

BookingTMS is a multi-tenant booking management system designed for experience-based businesses like escape rooms, rage rooms, and similar venues.

### Core Concept
```
Organization (Tenant) → Venue(s) → Activity(ies) → Time Slots → Bookings
```

### Key Features
- Multi-organization support (SaaS model)
- Multiple venues per organization
- Multiple activities per venue
- Automatic time slot generation
- Embeddable booking widgets
- Stripe payment integration
- Real-time availability

---

## Entity Hierarchy

```
┌─────────────────────────────────────────────────────────────────┐
│                        ORGANIZATION                              │
│  (Top-level tenant account - escape room business)               │
│                                                                   │
│  Fields: id, name, owner_email, plan_id, stripe_account_id       │
│  Managed by: System Admin, Super Admin                           │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────┐
│                           VENUE                                   │
│  (Physical location - "Downtown Escape Room")                     │
│                                                                   │
│  Fields: id, organization_id, name, address, embed_key, settings │
│  Managed by: Org Admin, Super Admin, System Admin                │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────┐
│                          ACTIVITY                                 │
│  (Bookable experience - "Zombie Apocalypse Room")                │
│                                                                   │
│  Fields: id, venue_id, organization_id, name, schedule, price    │
│  Managed by: Org Admin, Venue Manager, System Admin              │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────┐
│                      ACTIVITY_SESSIONS                            │
│  (Time slots - auto-generated from schedule)                      │
│                                                                   │
│  Fields: id, activity_id, start_time, end_time, capacity         │
│  Generated by: SessionService (automatic)                         │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            ▼
┌─────────────────────────────────────────────────────────────────┐
│                          BOOKINGS                                 │
│  (Customer reservations)                                          │
│                                                                   │
│  Fields: id, session_id, activity_id, customer_id, status        │
│  Created by: Customer via Widget, Staff via Admin                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## Database Schema

### Entity Relationship Diagram (ERD)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           BOOKINGTMS DATABASE ERD                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌──────────────────────┐         ┌──────────────────────┐                     │
│   │      auth.users      │◄────────┤       users          │                     │
│   │  (Supabase Auth)     │   1:1   │  (Profile + Role)    │                     │
│   └──────────────────────┘         └──────────┬───────────┘                     │
│                                               │                                  │
│                                               │ N:1                              │
│                                               ▼                                  │
│   ┌───────────────────────────────────────────────────────────────────────┐     │
│   │                         organizations (4 rows)                         │     │
│   │                                                                        │     │
│   │  id, name, owner_email, owner_name, stripe_account_id,                │     │
│   │  stripe_connect_enabled, plan_id, status, primary_color               │     │
│   └────────────────────────┬──────────────────────────────────────────────┘     │
│                            │                                                     │
│            ┌───────────────┼───────────────────┬─────────────────┐              │
│            │               │                   │                 │              │
│            ▼               ▼                   ▼                 ▼              │
│   ┌────────────────┐ ┌────────────┐ ┌─────────────────┐ ┌────────────────┐     │
│   │  venues (6)    │ │   users    │ │ embed_configs   │ │ organization_  │     │
│   │                │ │   (2)      │ │     (7)         │ │  members (2)   │     │
│   └───────┬────────┘ └────────────┘ └─────────────────┘ └────────────────┘     │
│           │                                                                      │
│           │ 1:N                                                                  │
│           ▼                                                                      │
│   ┌──────────────────────────────────────────────────────────────────────┐      │
│   │                        activities (10 rows)                           │      │
│   │                                                                       │      │
│   │  id, venue_id, organization_id, name, description, duration,         │      │
│   │  price, min_players, max_players, schedule (JSONB), is_active,       │      │
│   │  stripe_product_id, stripe_price_id                                   │      │
│   └────────────────────────┬─────────────────────────────────────────────┘      │
│                            │                                                     │
│                            │ 1:N                                                 │
│                            ▼                                                     │
│   ┌──────────────────────────────────────────────────────────────────────┐      │
│   │                   activity_sessions (2,305 rows)                      │      │
│   │                                                                       │      │
│   │  id, activity_id, venue_id, organization_id, start_time, end_time,   │      │
│   │  capacity_total, capacity_remaining, is_closed                        │      │
│   └────────────────────────┬─────────────────────────────────────────────┘      │
│                            │                                                     │
│            ┌───────────────┴───────────────┐                                    │
│            │                               │                                    │
│            ▼                               ▼                                    │
│   ┌─────────────────────┐        ┌─────────────────────┐                       │
│   │   bookings (2)      │        │ slot_reservations   │                       │
│   │                     │        │  (temp holds)       │                       │
│   │  session_id         │        └─────────────────────┘                       │
│   │  activity_id        │                                                       │
│   │  customer_id ───────┼──────────────┐                                       │
│   │  venue_id           │              │                                       │
│   │  organization_id    │              ▼                                       │
│   │  total_amount       │    ┌─────────────────────┐                           │
│   │  status             │    │  customers (6)      │                           │
│   │  payment_status     │    │                     │                           │
│   │  stripe_payment_id  │    │  id, email, name,   │                           │
│   └─────────────────────┘    │  phone, org_id      │                           │
│                              └─────────────────────┘                           │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘

RELATIONSHIPS:
─────────────────────────────────────────────────────────────────────────────────
• organizations 1:N venues (organization_id)
• organizations 1:N activities (organization_id) 
• organizations 1:N users (organization_id)
• organizations 1:N customers (organization_id)
• organizations 1:N embed_configs (organization_id)
• organizations 1:N organization_members (organization_id)
• venues 1:N activities (venue_id)
• venues 1:N activity_sessions (venue_id)
• activities 1:N activity_sessions (activity_id)
• activity_sessions 1:N bookings (session_id)
• activity_sessions 1:N slot_reservations (session_id)
• customers 1:N bookings (customer_id)
• auth.users 1:1 users (id)
```

### Current Database Statistics (Nov 30, 2025)

| Table | Row Count | RLS Enabled |
|-------|-----------|-------------|
| organizations | 4 | ✅ |
| venues | 6 | ✅ |
| activities | 10 | ✅ |
| activity_sessions | 2,305 | ✅ |
| bookings | 2 | ✅ |
| customers | 6 | ✅ |
| users | 2 | ✅ |
| embed_configs | 7 | ✅ |
| organization_members | 2 | ✅ |

### Organizations Table
```sql
organizations (
  id UUID PRIMARY KEY,
  name TEXT NOT NULL,
  owner_name TEXT,
  owner_email TEXT,
  plan_id UUID REFERENCES plans(id),
  stripe_account_id TEXT,
  stripe_charges_enabled BOOLEAN,
  stripe_payouts_enabled BOOLEAN,
  application_fee_percentage DECIMAL,
  status TEXT DEFAULT 'pending',
  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
)
```

### Venues Table
```sql
venues (
  id UUID PRIMARY KEY,
  organization_id UUID REFERENCES organizations(id),
  name TEXT NOT NULL,
  address TEXT,
  city TEXT,
  state TEXT,
  zip TEXT,
  country TEXT,
  phone TEXT,
  email TEXT,
  timezone TEXT DEFAULT 'America/New_York',
  embed_key TEXT UNIQUE, -- Auto-generated for embedding
  primary_color TEXT DEFAULT '#2563eb',
  settings JSONB,
  status TEXT DEFAULT 'active',
  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
)
```

### Activities Table
```sql
activities (
  id UUID PRIMARY KEY,
  venue_id UUID REFERENCES venues(id),
  organization_id UUID REFERENCES organizations(id),
  name TEXT NOT NULL,
  description TEXT,
  tagline TEXT,
  category TEXT,
  activity_type TEXT, -- 'physical', 'virtual', 'hybrid'
  event_type TEXT, -- 'public', 'private'
  duration INTEGER, -- minutes
  capacity INTEGER,
  price DECIMAL,
  schedule JSONB, -- Schedule configuration
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
)
```

### Activity Sessions Table
```sql
activity_sessions (
  id UUID PRIMARY KEY,
  activity_id UUID REFERENCES activities(id),
  venue_id UUID REFERENCES venues(id),
  organization_id UUID REFERENCES organizations(id),
  start_time TIMESTAMPTZ NOT NULL,
  end_time TIMESTAMPTZ NOT NULL,
  capacity_total INTEGER,
  capacity_remaining INTEGER,
  price_at_generation DECIMAL,
  is_closed BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ
)
```

### Bookings Table
```sql
bookings (
  id UUID PRIMARY KEY,
  session_id UUID REFERENCES activity_sessions(id),
  activity_id UUID REFERENCES activities(id),
  venue_id UUID REFERENCES venues(id),
  organization_id UUID REFERENCES organizations(id),
  customer_id UUID REFERENCES customers(id),
  guest_count INTEGER,
  total_amount DECIMAL,
  status TEXT DEFAULT 'pending',
  payment_status TEXT,
  stripe_payment_intent_id TEXT,
  created_at TIMESTAMPTZ,
  updated_at TIMESTAMPTZ
)
```

---

## Widget System

### Widget Types

| Widget Type | Component | Purpose | URL Parameter |
|------------|-----------|---------|---------------|
| **Venue Calendar** | `CalendarWidget` | Shows ALL activities in a venue | `widget=calendar` |
| **Activity Booking** | `CalendarSingleEventBookingPage` | Books a SINGLE activity | `widget=singlegame` or `widget=booking` |

### Widget Flow

```
┌──────────────────────────────────────────────────────────────────┐
│                      VENUE WIDGET (Full Calendar)                 │
│                                                                   │
│  URL: /embed?widget=calendar&key={venue_embed_key}               │
│  Component: CalendarWidget                                        │
│                                                                   │
│  Features:                                                        │
│  - Lists all activities in the venue                             │
│  - Customer selects activity → date → time slot                  │
│  - Shows availability across all activities                       │
└──────────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────────┐
│                    ACTIVITY WIDGET (Single Calendar)              │
│                                                                   │
│  URL: /embed?widget=singlegame&key={venue_embed_key}             │
│       &activityId={activity_id}                                   │
│  Component: CalendarSingleEventBookingPage                        │
│                                                                   │
│  Features:                                                        │
│  - Focused on single activity                                     │
│  - Customer selects date → time slot → checkout                  │
│  - Optimized conversion flow                                      │
└──────────────────────────────────────────────────────────────────┘
```

### Widget Configuration

Widgets are configured through:
1. **Venue Settings** (`venues.settings.widgetConfig`)
2. **Activity Wizard Step 7** (`Step7WidgetEmbedNew.tsx`)

Configuration options include:
- Primary color
- Theme (light/dark)
- Business information
- Categories
- Games/Activities list
- Additional questions
- Cancellation policy

---

## Booking Flow

### Customer Booking Journey

```
1. Customer visits embedded widget or booking page
                    │
                    ▼
2. Widget loads venue config via embedKey
   └─ SupabaseBookingService.getVenueWidgetConfig()
                    │
                    ▼
3. Customer selects Activity (if venue widget)
   └─ Or pre-selected (if activity widget)
                    │
                    ▼
4. Customer selects Date on calendar
   └─ Shows available dates based on schedule
                    │
                    ▼
5. Customer selects Time Slot
   └─ Lists available sessions from activity_sessions
                    │
                    ▼
6. Customer enters details & proceeds to checkout
   └─ Guest count, contact info, additional questions
                    │
                    ▼
7. Payment via Stripe Checkout
   └─ CheckoutService.createBookingWithCheckout()
                    │
                    ▼
8. Booking confirmed
   └─ Session capacity decremented
   └─ Confirmation email sent
```

### Key Services

| Service | Location | Purpose |
|---------|----------|---------|
| `SupabaseBookingService` | `/src/services/SupabaseBookingService.ts` | Widget data loading, public booking |
| `BookingService` | `/src/lib/bookings/bookingService.ts` | Admin booking operations |
| `CheckoutService` | `/src/lib/payments/checkoutService.ts` | Stripe checkout integration |
| `SessionService` | `/src/services/session.service.ts` | Time slot generation |
| `ActivityService` | `/src/modules/inventory/services/activity.service.ts` | Activity CRUD |

---

## Embed System

### Generating Embed Codes

**For Venues** (from `Venues.tsx`):
```javascript
// Venue embed uses widget=calendar
const embedUrl = `${baseUrl}/embed?widget=calendar&key=${venue.embedKey}`;
```

**For Activities** (from `Step7WidgetEmbedNew.tsx`):
```javascript
// Activity embed uses widget=singlegame
const embedUrl = `${baseUrl}/embed?widget=singlegame&key=${venue.embedKey}&activityId=${activityId}`;
```

### Embed Flow

```
1. External website loads iframe with embed URL
                    │
                    ▼
2. Embed.tsx parses URL parameters
   └─ widget, key, color, theme, mode
                    │
                    ▼
3. Fetches venue config from Supabase
   └─ Uses embedKey to find venue
   └─ Loads activities for that venue
                    │
                    ▼
4. Renders appropriate widget component
   └─ CalendarWidget or CalendarSingleEventBookingPage
                    │
                    ▼
5. Widget communicates with parent via postMessage
   └─ Resize events
   └─ Booking completion
```

---

## Time Slot Generation

### Schedule Configuration (Step 5)

Activities have a `schedule` JSONB field containing:
```typescript
interface ActivityScheduleRules {
  operatingDays: string[];     // ['Monday', 'Tuesday', ...]
  startTime: string;           // '09:00'
  endTime: string;             // '22:00'
  slotInterval: number;        // 60 (minutes)
  customHours?: Record<string, { enabled: boolean; startTime: string; endTime: string }>;
  customDates?: Array<{ date: string; startTime: string; endTime: string }>;
}
```

### Session Generation Process

```
SessionService.generateSessions(activityId, daysToGenerate)
                    │
                    ▼
1. Fetch activity and venue (for timezone)
                    │
                    ▼
2. Loop through each day (default 90 days ahead)
                    │
                    ▼
3. Check if day is in operatingDays
                    │
                    ▼
4. Generate slots from startTime to endTime
   └─ Using slotInterval (e.g., every 60 minutes)
                    │
                    ▼
5. Convert venue local time to UTC
                    │
                    ▼
6. Insert sessions into activity_sessions table
   └─ capacity_total = activity.capacity
   └─ capacity_remaining = activity.capacity
```

### When Sessions Are Generated

- **Manual**: Via "Generate Slots" action (to be implemented)
- **Automatic**: After activity is published (to be implemented)
- **Rolling**: Cron job to extend into future (recommended for production)

---

## User Roles & Permissions

| Role | Scope | Can Manage |
|------|-------|------------|
| `system-admin` | Platform-wide | All orgs, venues, activities |
| `super-admin` | Organization | Own org's venues, activities |
| `org-admin` | Organization | Own org's venues, activities |
| `admin` | Organization | Venues, activities, bookings |
| `manager` | Venue | Activities, bookings |
| `staff` | Venue | View bookings, check-in |
| `customer` | N/A | Own bookings only |

### Permission Checks

```typescript
// In components
const { hasPermission, isRole } = useAuth();

// Check specific permission
if (hasPermission('activities.create')) { ... }

// Check role
if (isRole('system-admin')) { ... }
```

---

## Key Services

### ActivityService
**Location**: `/src/modules/inventory/services/activity.service.ts`

| Method | Purpose |
|--------|---------|
| `createActivity()` | Create new activity |
| `updateActivity()` | Update existing activity |
| `deleteActivity()` | Delete activity |
| `getActivity()` | Get single activity |
| `listActivities()` | List activities for venue |

### SessionService
**Location**: `/src/services/session.service.ts`

| Method | Purpose |
|--------|---------|
| `generateSessions()` | Create time slots for activity |
| `listAvailableSessions()` | Get bookable sessions |
| `getSessionByTime()` | Find specific session |

### SupabaseBookingService
**Location**: `/src/services/SupabaseBookingService.ts`

| Method | Purpose |
|--------|---------|
| `getVenueByEmbedKey()` | Fetch venue for widget |
| `getVenueActivities()` | Fetch activities for venue |
| `getVenueWidgetConfig()` | Get complete widget config |
| `createWidgetBooking()` | Create booking from widget |

---

## File Structure

```
src/
├── components/
│   ├── events/
│   │   ├── steps/
│   │   │   ├── Step1BasicInfo.tsx      # Name, org, venue selection
│   │   │   ├── Step2CapacityPricing.tsx # Capacity, pricing tiers
│   │   │   ├── Step3ActivityDetails.tsx # Duration, difficulty
│   │   │   ├── Step4MediaUpload.tsx     # Images
│   │   │   ├── Step5Schedule.tsx        # Operating days, hours
│   │   │   ├── Step6PaymentSettings.tsx # Stripe config
│   │   │   ├── Step7WidgetEmbedNew.tsx  # Embed code generation
│   │   │   └── Step8Review.tsx          # Final review
│   │   └── AddServiceItemWizard.tsx     # Main wizard container
│   │
│   ├── widgets/
│   │   ├── CalendarWidget.tsx           # Venue full calendar
│   │   ├── CalendarSingleEventBookingPage.tsx # Activity booking
│   │   └── EmbedPreview.tsx             # Embed code preview
│   │
│   └── organizations/
│       └── OrganizationSettingsModal.tsx
│
├── pages/
│   ├── Organizations.tsx    # Org management (System Admin)
│   ├── Venues.tsx          # Venue management
│   ├── Events.tsx          # Activity management
│   ├── Embed.tsx           # Widget rendering endpoint
│   └── Bookings.tsx        # Booking management
│
├── services/
│   ├── session.service.ts          # Time slot generation
│   └── SupabaseBookingService.ts   # Widget booking operations
│
├── modules/
│   └── inventory/
│       └── services/
│           └── activity.service.ts  # Activity CRUD
│
└── lib/
    ├── bookings/
    │   └── bookingService.ts        # Admin booking operations
    ├── payments/
    │   └── checkoutService.ts       # Stripe checkout
    └── embed/
        └── EmbedManager.ts          # Embed code generation
```

---

## Real-Time Widget System

### Overview
The booking widgets use Supabase Real-time to provide instant updates across all users.

### Data Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                      ADMIN UPDATES FLOW                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   Admin Dashboard                                                │
│        │                                                         │
│        ▼                                                         │
│   ActivityService.updateActivity()                               │
│        │                                                         │
│        ├─→ Updates `activities` table                            │
│        │                                                         │
│        └─→ SessionService.generateSessions()                     │
│                   │                                              │
│                   ▼                                              │
│            Updates `activity_sessions` table                     │
│                   │                                              │
│                   ▼                                              │
│            Supabase broadcasts UPDATE event                      │
│                   │                                              │
│                   ▼                                              │
│            useWidgetData receives event                          │
│                   │                                              │
│                   ▼                                              │
│            Widget re-renders with new data                       │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                      BOOKING FLOW                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   Customer selects time slot                                     │
│        │                                                         │
│        ▼                                                         │
│   CheckoutService.createBookingWithCheckout()                    │
│        │                                                         │
│        ├─→ Creates booking record                                │
│        │                                                         │
│        └─→ updateSessionCapacity()                               │
│                   │                                              │
│                   ▼                                              │
│            capacity_remaining decremented                        │
│                   │                                              │
│                   ▼                                              │
│            Supabase broadcasts UPDATE event                      │
│                   │                                              │
│                   ▼                                              │
│            Other widgets see slot unavailable                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Key Components

| Component | Location | Purpose |
|-----------|----------|---------|
| `useWidgetData` | `/src/hooks/useWidgetData.ts` | Fetches + subscribes to real-time updates |
| `CheckoutService` | `/src/lib/payments/checkoutService.ts` | Handles bookings + capacity updates |
| `Embed.tsx` | `/src/pages/Embed.tsx` | Widget container with real-time subscriptions |
| `SupabaseBookingService` | `/src/services/SupabaseBookingService.ts` | Widget data loading |

### Real-Time Subscriptions

```typescript
// useWidgetData subscribes to:
supabase.channel(`activities-venue-${venueId}`)
  .on('postgres_changes', { table: 'activities', filter: `venue_id=eq.${venueId}` })

supabase.channel(`sessions-activity-${activityId}`)  
  .on('postgres_changes', { table: 'activity_sessions', filter: `activity_id=eq.${activityId}` })
```

### Embed URL Format
```
/embed?widget=calendar&key={venue_embed_key}&color={hex_color}&theme={light|dark}
```

### What Updates in Real-Time
- **Price changes**: Immediate reflection in widget
- **Schedule changes**: Sessions regenerated, widget updates
- **Blocked dates**: Sessions marked unavailable
- **Bookings**: Capacity decrements, availability updates

---

## Router Architecture

### Route Priority
Routes are defined in `/src/router.tsx`. Order matters!

```
1. Explicit admin routes (e.g., /dashboard, /organizations)
2. /:slug - Public venue profile pages
3. /* - 404 catch-all
```

### Important Routes

| Route | Component | Purpose |
|-------|-----------|---------|
| `/dashboard` | Dashboard | Main admin dashboard |
| `/organizations` | Organizations | Manage all organizations |
| `/venues` | Venues | Venue management |
| `/events` | Events | Activity management |
| `/system-admin` | SystemAdminDashboard | Platform-level admin |
| `/:slug` | VenueProfile | Public venue page |
| `/embed?widget=...` | Embed | Widget rendering |

### Adding New Routes
**IMPORTANT**: All admin routes must be explicitly defined BEFORE the `/:slug` catch-all route in `router.tsx`.

---

## Edge Functions (Supabase)

### Deployed Edge Functions

| Function | Purpose | Auth Required |
|----------|---------|---------------|
| `create-booking` | Create bookings from widget | No (Public) |
| `stripe-webhook` | Handle Stripe events | Yes (Stripe) |
| `generate-sessions` | Auto-generate time slots | Yes |
| `stripe-manage-product` | Sync products/prices | Yes |
| `create-staff-member` | Create staff users | Yes |
| `create-checkout-session` | Stripe Checkout | Yes |
| `verify-checkout-session` | Verify payment | Yes |
| `stripe-direct` | Direct Stripe API calls | Yes |
| `widget-api` | Widget data API | Yes |
| `create-org-admin` | Create org admin users | Yes |
| `admin-password-reset` | Admin password operations | Yes (Admin only) |

### Admin Password Reset Function

```typescript
// POST /functions/v1/admin-password-reset
{
  action: 'send_reset' | 'set_password',
  email: string,        // For send_reset
  userName?: string,    // For personalized email
  userId?: string,      // For set_password
  newPassword?: string  // For set_password
}
```

---

## Authentication Architecture

### Flow Types

| Flow | Method | Email Provider |
|------|--------|----------------|
| User Forgot Password | `supabase.auth.resetPasswordForEmail()` | Supabase built-in |
| Admin Reset User | Edge Function + Service Role | Resend |
| Admin Set Password | Edge Function + Service Role | N/A |

### Tenant Isolation

- All data filtered by `organization_id` 
- RLS policies enforce database-level isolation
- Org admins see only their organization's data
- System/Super admins can see all data

---

## Supabase Project Details

- **Project ID**: `qftjyjpitnoapqxlrvfs`
- **Project Name**: Embed PRO | Booking TMS Beta V 0.17 With AI Features
- **Region**: us-west-1
- **Database Version**: PostgreSQL 17.6.1
- **Status**: ACTIVE_HEALTHY

---

## Next Steps

1. ✅ **Session Auto-Generation**: Implemented via `generate-sessions` edge function
2. ✅ **Real-time Availability**: Implemented via Supabase real-time subscriptions
3. ✅ **Admin Password Reset**: Implemented via `admin-password-reset` edge function
4. ⏳ **Production Cron**: Set up rolling session generation for 90+ days ahead

---

*Document maintained by the development team. Last reviewed: November 30, 2025.*
