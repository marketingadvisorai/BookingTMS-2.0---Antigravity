# ‚úÖ Render CLI Setup Complete!

## üéâ What's Been Done

### ‚úÖ **Render CLI Installed**
- **Version:** 2.5.0
- **Installed via:** Homebrew
- **Command:** `render`

### ‚úÖ **Deployment Files Ready**
- `render.yaml` - Service configuration
- `deploy-to-render.sh` - Deployment script
- `RENDER_DEPLOYMENT_GUIDE.md` - Complete guide
- `src/backend/tsconfig.json` - TypeScript config
- `src/backend/.gitignore` - Security

### ‚úÖ **Branch Ready**
- **Branch:** `backend-render-deploy`
- **Status:** Pushed to GitHub
- **Ready:** For deployment

---

## üöÄ Quick Deploy (3 Steps)

### **Step 1: Complete Login**
The Render CLI login is currently waiting for you to select a workspace.

**In your terminal:**
1. Use arrow keys to select your workspace
2. Press Enter to confirm
3. You'll see: "‚úÖ Logged in successfully"

### **Step 2: Run Deployment Script**
```bash
./deploy-to-render.sh
```

This script will:
- ‚úÖ Verify you're on the right branch
- ‚úÖ Commit any changes
- ‚úÖ Push to GitHub
- ‚úÖ Show you next steps

### **Step 3: Create Service on Render**

**Go to:** [Render Dashboard](https://dashboard.render.com)

**Click:** "New +" ‚Üí "Web Service"

**Configure:**
```
Repository: Select your GitHub repo
Branch: backend-render-deploy
Name: bookingtms-backend-api
Build Command: cd src/backend && npm install && npm run build
Start Command: cd src/backend && npm start
Plan: Free
```

**Add Environment Variables:**
```bash
NODE_ENV=production
PORT=3001
SUPABASE_URL=your_supabase_url
SUPABASE_SERVICE_ROLE_KEY=your_key
STRIPE_SECRET_KEY=your_stripe_key
STRIPE_PUBLISHABLE_KEY=your_publishable_key
STRIPE_WEBHOOK_SECRET=your_webhook_secret
# ... (see full list below)
```

**Click:** "Create Web Service"

---

## üîê Required Environment Variables

### **Supabase (Required)**
```bash
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### **Stripe (Required)**
```bash
STRIPE_SECRET_KEY=sk_test_... or sk_live_...
STRIPE_PUBLISHABLE_KEY=pk_test_... or pk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...
```

### **SendGrid (Optional - for emails)**
```bash
SENDGRID_API_KEY=SG.your_api_key
SENDGRID_FROM_EMAIL=noreply@yourdomain.com
SENDGRID_FROM_NAME=BookingTMS
```

### **Twilio (Optional - for SMS)**
```bash
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_auth_token
TWILIO_PHONE_NUMBER=+1234567890
```

### **OpenAI (Optional - for AI features)**
```bash
OPENAI_API_KEY=sk-your_openai_key
OPENAI_ORG_ID=org-your_org_id
OPENAI_MODEL=gpt-4-turbo-preview
```

### **Security (Auto-generated by Render)**
```bash
JWT_SECRET=<click "Generate Value">
ENCRYPTION_KEY=<click "Generate Value">
```

### **CORS & Rate Limiting**
```bash
ALLOWED_ORIGINS=https://your-frontend-url.com,http://localhost:5173
SESSION_TIMEOUT=3600000
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

---

## üìä Useful Render CLI Commands

### **View Services**
```bash
render services list
```

### **View Logs**
```bash
render logs
# Then select your service
```

### **Trigger Deploy**
```bash
render deploys create
# Then select your service
```

### **Check Service Status**
```bash
render services get
# Then select your service
```

### **View Current User**
```bash
render whoami
```

---

## ‚úÖ Verification After Deployment

### **1. Check Health**
```bash
curl https://your-service-name.onrender.com/health
```

**Expected:**
```json
{
  "status": "healthy",
  "timestamp": "2025-01-11T...",
  "uptime": 123.456,
  "environment": "production"
}
```

### **2. Check API Info**
```bash
curl https://your-service-name.onrender.com/api
```

### **3. Test Configuration**
```bash
curl https://your-service-name.onrender.com/api/config
```

---

## üîÑ Auto-Deploy Setup

### **Enable Auto-Deploy:**
1. Go to your service in Render Dashboard
2. Click "Settings"
3. Scroll to "Build & Deploy"
4. Enable "Auto-Deploy"
5. Select branch: `backend-render-deploy`

**Now:** Every push to `backend-render-deploy` automatically deploys!

---

## üìù Post-Deployment Tasks

### **1. Update Frontend**
```typescript
// In your frontend .env file
VITE_BACKEND_API_URL=https://your-service-name.onrender.com
```

### **2. Configure Stripe Webhooks**
1. Go to [Stripe Dashboard](https://dashboard.stripe.com/webhooks)
2. Add endpoint: `https://your-service-name.onrender.com/api/webhooks/stripe`
3. Select events to listen for
4. Copy webhook signing secret
5. Update `STRIPE_WEBHOOK_SECRET` in Render

### **3. Test All Endpoints**
- ‚úÖ Health check
- ‚úÖ API info
- ‚úÖ Configuration status
- ‚úÖ Save API keys
- ‚úÖ Test connections

---

## üéØ Quick Reference

### **Your Service URL:**
```
https://your-service-name.onrender.com
```

### **Deployment Script:**
```bash
./deploy-to-render.sh
```

### **View Logs:**
```bash
render logs
```

### **Redeploy:**
```bash
git push origin backend-render-deploy
# (if auto-deploy enabled)
```

---

## üìö Documentation

- **Complete Guide:** `RENDER_DEPLOYMENT_GUIDE.md`
- **Backend Setup:** `src/backend/DEPLOYMENT.md`
- **Render Docs:** [render.com/docs](https://render.com/docs)
- **Render CLI Docs:** [render.com/docs/cli](https://render.com/docs/cli)

---

## üÜò Need Help?

### **Common Issues:**

**Login Issues:**
```bash
render login
# Follow browser prompts
```

**Service Not Starting:**
- Check environment variables are set
- Verify build completed successfully
- Check logs: `render logs`

**CORS Errors:**
- Update `ALLOWED_ORIGINS` in environment variables
- Include your frontend URL

---

## ‚úÖ Setup Status

- [x] Render CLI installed (v2.5.0)
- [x] Branch created (backend-render-deploy)
- [x] Deployment files ready
- [x] Branch pushed to GitHub
- [ ] **Complete login** (in progress)
- [ ] **Create service on Render**
- [ ] **Add environment variables**
- [ ] **Deploy and verify**

---

**Next Step:** Complete the Render CLI login in your terminal, then run `./deploy-to-render.sh`

**Estimated Time:** 10-15 minutes  
**Your backend is ready to deploy!** üöÄ
